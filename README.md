# AI 文本解释助手 - 浏览器插件

一个功能强大的浏览器插件，可以使用 OpenAI 兼容的 API 来解释网页中选中的文本内容。

## ✨ 功能特点

### 核心功能
- 📖 **读取网页内容** - 轻松访问网页上的任何文本
- ✂️ **读取用户选择** - 选择你想要解释的文本
- 🔧 **可配置的 API** - 支持任何 OpenAI 兼容的接口
- 🖱️ **右键菜单集成** - 添加"使用 AI 解释"到浏览器右键菜单
- 💬 **智能对话** - 与 AI 进行上下文对话
- ⚙️ **自定义提示词** - 配置系统提示词和用户提示词模板

### 🆕 高级功能
- 🌊 **流式输出** - 实时显示 AI 回复，无需等待完整响应
- 🧠 **思考链支持** - 展示 AI 推理过程（支持 o1 等模型）
- 📝 **Markdown 渲染** - 支持代码高亮、表格、列表等丰富格式
- 📌 **最小化功能** - 可将聊天框最小化，避免遮挡网页内容
- 🎨 **现代化 UI** - 美观的侧边栏界面，支持渐变色和流畅动画

## 📦 安装步骤

### Chrome / Edge 浏览器

1. 克隆或下载此项目到本地
2. 打开浏览器，访问扩展管理页面：
   - Chrome: `chrome://extensions/`
   - Edge: `edge://extensions/`
3. 开启右上角的「开发者模式」
4. 点击「加载已解压的扩展程序」
5. 选择项目文件夹
6. 插件安装成功！

## 🚀 使用方法

### 1. 配置 API

首次使用需要配置 OpenAI 兼容的 API：

1. 点击浏览器工具栏中的插件图标
2. 填写以下信息：
   - **API 接口地址**: 例如 `https://api.openai.com/v1/chat/completions`
   - **API 密钥**: 你的 API Key
   - **模型**: 例如 `gpt-3.5-turbo` 或 `gpt-4`
   - **Temperature**: 控制回复的随机性（0-2）
   - **最大 Tokens**: 回复的最大长度（根据模型限制设置，详见 [MODEL_LIMITS.md](MODEL_LIMITS.md)）
3. 配置提示词（可选）：
   - **系统提示词**: 定义 AI 的角色和行为
   - **用户提示词模板**: 使用 `{selectedText}` 作为选中文本的占位符
4. 点击「保存设置」
5. 点击「测试连接」验证配置是否正确

### 2. 使用 AI 解释文本

1. 在任何网页上选择你想要解释的文本
2. 右键点击选中的文本
3. 在右键菜单中选择「使用 AI 解释」
4. 侧边栏会自动打开，显示 AI 的解释
5. 你可以继续在输入框中与 AI 对话

### 3. 自定义对话

- 在侧边栏底部的输入框中输入你的问题
- 按 `Enter` 键或点击「发送」按钮
- AI 会基于上下文继续对话
- 使用 `Shift + Enter` 可以换行

### 4. 使用高级功能

#### 流式输出 🌊
- 在设置中勾选「启用流式输出」（默认开启）
- AI 回复会实时显示，无需等待完整响应
- 适合长文本解释，提升体验

#### 思考链 🧠
- 在设置中勾选「开启思考链」
- 适用于 OpenAI o1、o1-mini 等支持推理的模型
- AI 会展示思考和推理过程

#### Markdown 格式 📝
- AI 回复自动支持 Markdown 渲染
- 包括代码高亮、表格、列表等
- 无需额外配置

#### 最小化窗口 📌
- 点击标题栏的「−」按钮最小化
- 侧边栏会缩小到右下角
- 点击最小化窗口恢复完整界面

详细功能说明请查看 [FEATURES.md](FEATURES.md)

## ⚙️ 配置示例

### OpenAI 官方 API

```
API 接口地址: https://api.openai.com/v1/chat/completions
API 密钥: sk-your-api-key-here
模型: gpt-3.5-turbo
```

### Azure OpenAI

```
API 接口地址: https://your-resource.openai.azure.com/openai/deployments/your-deployment/chat/completions?api-version=2023-05-15
API 密钥: your-azure-api-key
模型: gpt-35-turbo
```

### 其他兼容服务

只要服务提供 OpenAI 兼容的 API，都可以使用：
- Claude (通过 AWS Bedrock)
- 本地部署的 LLM (如 Ollama、LocalAI)
- 其他第三方服务

## 🎯 Token 限制说明

不同模型有不同的 token 限制，设置时需要注意：

| 模型类型 | 总限制 | 推荐配置 |
|---------|--------|----------|
| GPT-3.5-turbo | 4,096 | 2,000 |
| GPT-4 | 8,192 | 4,000 |
| GPT-4-turbo | 128,000 | 64,000 |
| Claude-3 | 200,000 | 100,000 |
| Gemini-1.5-pro | 1,048,576 | 500,000 |

**注意**：总 token 数 = 输入 tokens + 输出 tokens

建议的最大 Tokens 设置为模型限制的 50-70%，为输入内容预留空间。

详细的模型限制和配置建议请参考 [MODEL_LIMITS.md](MODEL_LIMITS.md)。

## 📝 提示词模板示例

### 基础解释

**系统提示词**:
```
你是一个专业的助手，帮助用户理解和解释文本内容。
```

**用户提示词**:
```
请解释以下内容：

{selectedText}
```

### 简化解释

**系统提示词**:
```
你是一个擅长用简单语言解释复杂概念的老师。
```

**用户提示词**:
```
请用简单易懂的语言解释以下内容，就像对一个初学者解释一样：

{selectedText}
```

### 翻译 + 解释

**系统提示词**:
```
你是一个专业的翻译和解释助手。
```

**用户提示词**:
```
请将以下内容翻译成中文，并解释其含义：

{selectedText}
```

## 🎨 界面特性

- **渐变色设计** - 现代化的紫色渐变背景
- **流畅动画** - 平滑的打开和消息动画
- **响应式布局** - 适配不同屏幕尺寸
- **滚动优化** - 美化的滚动条样式
- **消息气泡** - 清晰区分用户和 AI 的消息
- **输入优化** - 支持多行输入和快捷键

## 🔒 隐私和安全

- API 密钥存储在浏览器的本地存储中
- 所有通信都通过 HTTPS 加密
- 不会收集或上传用户数据
- 选中的文本仅发送到你配置的 API 端点

## 🛠️ 开发

### 项目结构

```
.
├── manifest.json       # 插件配置文件
├── background.js       # 后台服务脚本
├── content.js          # 内容脚本（注入网页）
├── sidebar.css         # 侧边栏样式
├── popup.html          # 设置弹窗 HTML
├── popup.css           # 设置弹窗样式
├── popup.js            # 设置弹窗逻辑
└── icons/              # 插件图标
    ├── icon16.png
    ├── icon48.png
    └── icon128.png
```

### 技术栈

- **Manifest V3** - 最新的浏览器插件标准
- **原生 JavaScript** - 无依赖，纯原生实现
- **CSS3** - 现代化样式和动画
- **Chrome Extensions API** - 浏览器插件接口

### 调试

1. 在扩展管理页面中找到插件
2. 点击「检查视图」可以调试弹窗
3. 在网页上右键点击「检查」，在 Console 中可以看到内容脚本的日志
4. 点击「Service Worker」可以调试后台脚本

## 📄 许可证

MIT License

## 🤝 贡献

欢迎提交 Issue 和 Pull Request！

## 📧 联系方式

如有问题或建议，欢迎通过 Issue 联系。
